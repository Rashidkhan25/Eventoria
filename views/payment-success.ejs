<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Payment Successful | Eventoria</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/output.css">
  <link rel="stylesheet" href="/css/styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

  <style>
    .fade {
      opacity: 0;
      transform: translateY(20px);
    }

    #confetti-canvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9999;
    }

    .glow-card {
      box-shadow: 0 0 25px #3b82f68c;
    }
  </style>
</head>

<body class="bg-black text-white overflow-x-hidden font-sans">

  <canvas id="confetti-canvas"></canvas>

  <%- include("partials/navbar", { session }) %>

  <section class="min-h-screen flex flex-col justify-center items-center px-6 pt-24">

    <div class="fade mb-6">
      <div class="w-24 h-24 rounded-full bg-green-600 flex justify-center items-center shadow-lg">
        <svg width="50" height="50" fill="none" stroke="white" stroke-width="4" viewBox="0 0 24 24">
          <path d="M5 13l4 4L19 7" />
        </svg>
      </div>
    </div>

    <h1 class="fade text-4xl md:text-6xl font-zentry text-center mb-4">
      Payment Successful!
    </h1>

    <p class="fade text-gray-300 text-center text-lg max-w-xl mb-10">
      Your pass has been successfully booked for
      <span class="text-blue-400 font-semibold"><%= event.title %></span>.
      Get ready for an unforgettable experience!
    </p>

    <div class="fade bg-black/40 border border-blue-700 rounded-xl p-6 md:p-10 max-w-xl glow-card">

      <img src="<%= event.banner %>" class="rounded-lg mb-6 w-full h-52 object-cover" />

      <h2 class="text-3xl font-circular-web mb-2"><%= event.title %></h2>
      <p class="text-gray-400 mb-4"><%= event.tagline %></p>

      <div class="flex justify-between text-gray-300 mb-6">
        <p class="font-semibold">Event ID:</p>
        <p>#<%= event.id %></p>
      </div>

      <div class="flex justify-between text-gray-300 mb-6">
        <p class="font-semibold">Amount Paid:</p>
        <p>â‚¹ <%= event.price %></p>
      </div>

      <div class="mt-6 flex gap-4">
        <button class="px-6 py-3 bg-blue-700 hover:bg-blue-600 transition rounded-full">
          Download Ticket
        </button>

        <a href="/events" class="px-6 py-3 bg-white text-black rounded-full font-semibold hover:bg-gray-200 transition">
          Explore More Events
        </a>
      </div>
    </div>

  </section>

  <script>
    gsap.utils.toArray(".fade").forEach((el, i) => {
      gsap.to(el, {
        opacity: 1,
        y: 0,
        delay: 0.3 + i * 0.15,
        duration: 1.1,
        ease: "power3.out"
      });
    });

    const canvas = document.getElementById("confetti-canvas");
    const ctx = canvas.getContext("2d");

    let confetti = [];
    let w, h;
    function resize() {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    function createConfettiPiece() {
      return {
        x: Math.random() * w,
        y: Math.random() * -h,
        r: Math.random() * 6 + 2,
        d: Math.random() * 0.5 + 0.5,
        color: `hsl(${Math.random() * 360}, 90%, 60%)`
      };
    }

    function initConfetti() {
      for (let i = 0; i < 250; i++) {
        confetti.push(createConfettiPiece());
      }
    }

    function draw() {
      ctx.clearRect(0, 0, w, h);
      confetti.forEach((c, i) => {
        ctx.beginPath();
        ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
        ctx.fillStyle = c.color;
        ctx.fill();

        c.y += c.d;
        if (c.y > h) confetti[i] = createConfettiPiece();
      });
      requestAnimationFrame(draw);
    }

    initConfetti();
    draw();
  </script>

</body>
</html>
